#mongodb.conf - generated from Puppet

<% config = {'systemLog' => @system_log_config} -%>
<% config['processManagement'] = @process_management_config -%>
<% config['net'] = @net_config -%>
<% config['security'] = @security_config if @security_config -%>
<%= config.to_yaml %>

#Storage
storage.dbPath: <%= @dbpath %>
<% if @journal != nil -%>
storage.journal.enabled: <%= @journal %>
<% end -%>
<% if @noprealloc -%>
storage.preallocDataFiles: <%= !@noprealloc %>
<% end -%>
<% if @nssize -%>
storage.nsSize: <%= @nssize %>
<% end -%>
<% if @directoryperdb -%>
storage.directoryPerDB: <%= @directoryperdb %>
<% end -%>
<% if @smallfiles -%>
storage.smallFiles: <%= @smallfiles %>
<% end -%>
<% if @quota -%>
storage.quota.enforced: <%= @quota %>
<% if @quotafiles -%>
storage.quota.maxFilesPerDB: <%= @quotafiles %>
<% end -%>
<% end -%>
<% if @storage_engine_internal -%>
storage.engine: <%= @storage_engine_internal %>
<% end -%>

#Replication
<% if @replset -%>
replication.replSetName: <%= @replset %>
<% end -%>
<% if @oplog_size -%>
replication.oplogSizeMB: <%= @oplog_size %>
<% end -%>

#Sharding
<% if @configsvr -%>
sharding.clusterRole: configsvr
<% end -%>
<% if @shardsvr -%>
sharding.clusterRole: shardsvr
<% end -%>

#Operation Profiling
<% if @profile == "0" -%>
operationProfiling.mode: off
<% elsif @profile == "1" -%>
operationProfiling.mode: slowOp
<% elsif @profile == "2" -%>
operationProfiling.mode: all
<% end -%>
<% if @slowms -%>
operationProfiling.slowOpThresholdMs: <%= @slowms %>
<% end -%>

<% if @set_parameter -%>
setParameter:
<% [@set_parameter].flatten.each do |v| -%>
  <%= v %>
<% end -%>
<% end -%>

<% if @config_data -%>
<% @config_data.each do |k,v| -%>
<%= k %>: <%= v %>
<% end -%>
<% end -%>
